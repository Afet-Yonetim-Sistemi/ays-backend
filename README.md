# Afet YÃ¶netim Sistemi (AYS) Backend

## Tech Stack


Framework : 
* Core
    * Spring
        * Spring Boot 3
        * Spring Boot Test (Junit)
        * Spring Boot Dev Tools
        * Spring Security
        * Spring Web
        * Spring Boot JOOQ
        * Spring Boot Actuator
    * Spring Data
        * Spring Data JPA
        * Spring Data REST
    * Cache
        * Spring Cache

Databases :
* MYSQL
* H2 Database

Technologies :
* Lombok
* Test Containers

Language : 
* Java 17

Build Tool : 
* Maven

Software Development Process :
* TDD
* Agile Scrum

Version Control :
* Git

Database Change Management: 
* Liquibase


# Getting Started

The project has been generated by Spring Initializer.

## Building the project with tests

```
./mvnw clean install
```

## Running the project

```
./mvnw spring-boot:run
```

## Running locally

Don't forget to enable Lombok pre-processing in your IDE.

## Running as Docker container

After building the project, run below to build and tag the docker image.

```
docker build -t ays/ays-be .
```

For running the docker image, run the following command:

```
docker run -p 8080:8080 ays/ays-be
```

## Running with Docker Compose

You need to have .env.local file in the same directory with docker-compose.yml which will define
env variables used by the compose command - this file should not be committed:

```.env.local
MYSQLDB_USER=root
MYSQLDB_ROOT_PASSWORD=123456
MYSQLDB_DATABASE=afetdb
MYSQLDB_LOCAL_PORT=3307
MYSQLDB_DOCKER_PORT=3306
```

```
docker compose --env-file .env.local up -d
```

To terminate the containers:

```
docker compose --env-file .env.local down
```

## Running the app with Kubernetes

```
kubectl apply -f deployment.yaml
kubectl apply -f service.yaml
```

You should be able to see the service, deployment and pods. If you want to access the service using internal IP,
try using NodePort instead of LoadBalancer in service.yaml

# How to Contribute

The project is managed by [GitHub projects](https://github.com/orgs/afet-yonetim-sistemi/projects/3). You can assign
an issue from the Todo list and start working on it.

## Development Standards

This project uses [GitHub flow](https://docs.github.com/en/get-started/quickstart/github-flow) for collaboration.
You can see open issues [here](https://github.com/afet-yonetim-sistemi/ays-be/issues).
You can start working one of the open issues by assigning it to yourself.

For your feature branches, please ensure below:

- Make sure to associate your feature branch with the GitHub issue from 'Development' section in each issue page.
- main branch is protected.
- Your feature branches can be merged by pull request that is approved by at least one code owner.
- PR should be squash-merged to avoid having merge commit history.
- PR title and description should clearly define and explain the aim.
- PR title should contain the issue/feature/bug number e.g. Issue 7 - Readme Update
- PR should successfully complete build and any other necessary tests before being merged to main.
- Branches should follow the below pattern:
    feature/issue-no-other-desc
    bugfix/issue-no-other-desc
    hotfix/issue-no-other-desc (there may also be no issue number for some hotfixes)
- Each release should be tagged with a version
- Commit messages should be subjectless
    e.g. Add README.md
    e.g. Fix ...
- PR should be concise; don't try to fix/introduce more than one thing
- Do not include/push secret/credential information

## Docker Image Name Conventions

Docker images should be tagged as "org-name/project-name:version" e.g. "ays/ays-be:v1.0"
"ays/ays-be" indicates the latest version.

### Versioning

The project follows [the semantic versioning](https://semver.org/) i.e. MAJOR.MINOR.PATCH e.g. v1.9.9.

## Project Documents

AYS technical analysis can be found [here](https://docs.google.com/document/d/1_GyROvXrsD88udD6z_KfF-Q5Cs77YLHDglqafRXIV_o/edit).

For other information, you can contact the project's [Discord channel](https://discord.gg/HeunQcqg).
